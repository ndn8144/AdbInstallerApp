<Window x:Class="AdbInstallerApp.Views.MainWindow"
xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
xmlns:vm="clr-namespace:AdbInstallerApp.ViewModels"
mc:Ignorable="d"
Title="ADB APK Installer" Height="780" Width="1200"
Background="{StaticResource BackgroundBrush}"
WindowStartupLocation="CenterScreen">
<Window.DataContext>
<vm:MainViewModel/>
</Window.DataContext>


<Grid Margin="20">
<Grid.RowDefinitions>
<RowDefinition Height="Auto"/>
<RowDefinition Height="*"/>
<RowDefinition Height="200"/>
</Grid.RowDefinitions>

<!-- Header Section -->
<Border Background="{StaticResource SurfaceBrush}" 
        CornerRadius="8" 
        Padding="20" 
        Margin="0,0,0,16"
        BorderBrush="{StaticResource DividerBrush}"
        BorderThickness="1">
    <StackPanel>
        <!-- Title -->
        <TextBlock Text="📱 ADB APK Installer" 
                   FontSize="24" 
                   FontWeight="Bold" 
                   Foreground="{StaticResource TextPrimaryBrush}"
                   Margin="0,0,0,16"/>
        
        <!-- Toolbar -->
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Folder Selection Row -->
            <StackPanel Orientation="Horizontal" Margin="0,0,0,12">
                <Button Content="📁 Choose APK Folder" 
                        Style="{StaticResource ModernButtonStyle}"
                        Command="{Binding ChooseRepoCommand}" 
                        Margin="0,0,12,0"/>
                <TextBox Text="{Binding ApkRepoPath}" 
                         Style="{StaticResource ModernTextBoxStyle}"
                         IsReadOnly="True" 
                         Width="450" 
                         VerticalAlignment="Center"
                         Margin="0,0,12,0"/>
                <Button Content="🔄 Rescan"
                        Style="{StaticResource ModernButtonStyle}"
                        Command="{Binding RefreshRepoCommand}"/>
            </StackPanel>
            
            <!-- Options and Install Row -->
            <Grid Grid.Row="1">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <CheckBox Content="Reinstall (-r)" 
                              IsChecked="{Binding OptReinstall}" 
                              Margin="0,0,16,0"
                              VerticalAlignment="Center"/>
                    <CheckBox Content="Grant Permissions (-g)" 
                              IsChecked="{Binding OptGrantPerms}" 
                              Margin="0,0,16,0"
                              VerticalAlignment="Center"/>
                    <CheckBox Content="Allow Downgrade (-d)" 
                              IsChecked="{Binding OptDowngrade}"
                              VerticalAlignment="Center"/>
                </StackPanel>
                
                <Button Grid.Column="1" 
                        Content="⚡ Install on Selected Devices" 
                        Style="{StaticResource AccentButtonStyle}"
                        Command="{Binding InstallOnSelectedCommand}"
                        FontSize="14"
                        Padding="20,10"/>
            </Grid>
        </Grid>
    </StackPanel>
</Border>


<!-- Content Area -->
<Grid Grid.Row="1" Margin="0,0,0,16">
<Grid.ColumnDefinitions>
<ColumnDefinition Width="2*"/>
<ColumnDefinition Width="12"/>
<ColumnDefinition Width="3*"/>
</Grid.ColumnDefinitions>

<!-- Devices Section -->
<GroupBox Header="📱 Connected Devices (Real-time)" 
          Style="{StaticResource ModernGroupBoxStyle}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" 
                   Text="Select devices to install APKs" 
                   Foreground="{StaticResource TextSecondaryBrush}"
                   Margin="0,0,0,8"/>
        
        <DataGrid Grid.Row="1" 
                  ItemsSource="{Binding Devices}" 
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserResizeRows="False"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  SelectionMode="Single"
                  Background="{StaticResource SurfaceBrush}"
                  RowBackground="{StaticResource SurfaceBrush}"
                  AlternatingRowBackground="#F8F9FA">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Binding="{Binding IsSelected}" 
                                        Header="✓" 
                                        Width="40"/>
                <DataGridTextColumn Binding="{Binding DisplayName}" 
                                    Header="Device" 
                                    Width="180"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding DeviceInfo}" 
                                    Header="Android Info" 
                                    Width="120"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding RootStatus}" 
                                    Header="Root" 
                                    Width="80"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding Architecture}" 
                                    Header="Arch" 
                                    Width="60"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding State}" 
                                    Header="Status" 
                                    Width="80"
                                    IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</GroupBox>

<!-- APK Repository Section -->
<GroupBox Grid.Column="2" 
          Header="📦 APK Repository" 
          Style="{StaticResource ModernGroupBoxStyle}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <TextBlock Grid.Row="0" 
                   Text="Select APK files to install" 
                   Foreground="{StaticResource TextSecondaryBrush}"
                   Margin="0,0,0,8"/>
        
        <DataGrid Grid.Row="1" 
                  ItemsSource="{Binding ApkFiles}" 
                  AutoGenerateColumns="False" 
                  CanUserAddRows="False"
                  CanUserDeleteRows="False"
                  CanUserResizeRows="False"
                  GridLinesVisibility="Horizontal"
                  HeadersVisibility="Column"
                  SelectionMode="Single"
                  Background="{StaticResource SurfaceBrush}"
                  RowBackground="{StaticResource SurfaceBrush}"
                  AlternatingRowBackground="#F8F9FA">
            <DataGrid.Columns>
                <DataGridCheckBoxColumn Binding="{Binding IsSelected}" 
                                        Header="✓" 
                                        Width="40"/>
                <DataGridTextColumn Binding="{Binding DisplayInfo}" 
                                    Header="APK Info" 
                                    Width="200"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding FileSize}" 
                                    Header="Size" 
                                    Width="80"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding LastModified}" 
                                    Header="Modified" 
                                    Width="120"
                                    IsReadOnly="True"/>
                <DataGridTextColumn Binding="{Binding SplitTag}" 
                                    Header="Split" 
                                    Width="80"
                                    IsReadOnly="True"/>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</GroupBox>
</Grid>


<!-- Log Section -->
<GroupBox Grid.Row="2" 
          Header="📄 Installation Log" 
          Style="{StaticResource ModernGroupBoxStyle}">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <StackPanel Grid.Row="0" 
                    Orientation="Horizontal" 
                    Margin="0,0,0,8">
            <TextBlock Text="Real-time installation progress and logs" 
                       Foreground="{StaticResource TextSecondaryBrush}"
                       VerticalAlignment="Center"/>
            <Button Content="🗑️ Clear" 
                    Style="{StaticResource ModernButtonStyle}"
                    Padding="8,4"
                    FontSize="11"
                    Margin="16,0,0,0"
                    Click="ClearLog_Click"/>
        </StackPanel>
        
        <Border Grid.Row="1" 
                Background="#1E1E1E" 
                CornerRadius="4" 
                BorderBrush="{StaticResource DividerBrush}"
                BorderThickness="1">
            <ScrollViewer VerticalScrollBarVisibility="Auto" 
                          HorizontalScrollBarVisibility="Auto"
                          Padding="12">
                <TextBox Text="{Binding LogText}" 
                         Background="Transparent"
                         Foreground="#FFFFFF"
                         FontFamily="Consolas" 
                         FontSize="12"
                         TextWrapping="NoWrap" 
                         AcceptsReturn="True" 
                         BorderThickness="0"
                         IsReadOnly="True"
                         VerticalScrollBarVisibility="Disabled"
                         HorizontalScrollBarVisibility="Disabled"/>
            </ScrollViewer>
        </Border>
    </Grid>
</GroupBox>
</Grid>
</Window>